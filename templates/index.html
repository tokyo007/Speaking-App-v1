<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>MVP Speaking App ‚Äî Prompt (Exam Selection)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root{
      --brand-bg:#0b132b; --brand:#1c7ed6; --accent:#f59e0b;
      --card:#ffffff; --ink:#0f172a; --muted:#64748b; --border:#e5e7eb;
    }
    *{box-sizing:border-box}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#f6f7fb;color:var(--ink)}
    header{background:var(--brand-bg);color:#fff;padding:16px;display:flex;align-items:center;justify-content:space-between}
    header h1{margin:0;font-size:18px}
    header a{color:#fff;text-decoration:none;opacity:.9}
    .wrap{max-width:980px;margin:16px auto;padding:0 16px}
    .card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;box-shadow:0 1px 2px rgba(0,0,0,.03)}
    .row{display:flex;gap:8px;flex-wrap:wrap;align-items:center}
    .muted{color:var(--muted);font-size:13px}
    label{font-size:13px;color:var(--muted)}
    select,button{border:1px solid var(--border);border-radius:10px;padding:10px;background:#fff}
    button.primary{background:var(--brand);color:#fff;border-color:transparent}
    button.warn{background:var(--accent);color:#111;border-color:transparent}
    button:disabled{opacity:.6;cursor:not-allowed}
    #promptBox{background:#fbfdff;border:1px solid var(--border);border-radius:12px;padding:12px}
    audio{display:block;margin-top:8px}
    @media (max-width:520px){
      header h1{font-size:16px}
      select,button{width:100%}
    }
  </style>
</head>
<body>
  <header>
    <h1>MakoStars ‚Ä¢ Speaking (Exam Prompt)</h1>
    <a href="/report">View Last Report ‚Üí</a>
  </header>

  <main class="wrap">
    <section class="card">
      <h2 style="margin:0 0 6px">Course B ‚Äî Prompt Response</h2>
      <p class="muted" style="margin:0 0 12px">
        Choose a test ‚Üí group ‚Üí question. Record a 30‚Äì60s answer. We‚Äôll assess pronunciation and show your report.
      </p>

      <div class="row" style="margin-bottom:8px">
        <label for="testType">Test</label>
        <select id="testType" aria-label="Test type"></select>

        <label for="groupId">Group</label>
        <select id="groupId" aria-label="Question group"></select>

        <label for="questionId">Question</label>
        <select id="questionId" aria-label="Question"></select>

        <button id="randQ" class="warn" type="button" title="Random question">üé≤ Random</button>
      </div>

      <div id="promptBox">
        <div class="muted" style="margin-bottom:6px">Prompt</div>
        <div id="promptText" style="line-height:1.5"></div>
      </div>

      <div class="row" style="margin-top:10px">
        <label for="lang">Language</label>
        <select id="lang">
          <option value="en-US">English (US)</option>
          <option value="en-GB">English (UK)</option>
        </select>
      </div>

      <div class="row" style="margin-top:12px">
        <button id="recordBtn" class="primary" type="button">üé§ Record</button>
        <button id="stopBtn" type="button" disabled>‚èπ Stop</button>
        <span id="status" class="muted"></span>
      </div>

      <audio id="playback" controls></audio>

      <p class="muted" style="margin-top:8px">
        Tip: If embedded in an LMS iframe, the iframe must include <code>allow="microphone"</code>.
      </p>
    </section>
  </main>

  <!-- Load AFTER the DOM so addEventListener finds the elements -->
  <script src="/static/recorder.js?v=2025-08-10-3"></script>
</body>
</html>
